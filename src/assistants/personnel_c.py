"""
人員 C (視覺設計) AI Agent
"""

from .base_assistant import BaseAssistant
from typing import Dict


class PersonnelCAssistant(BaseAssistant):
    """人員 C (視覺設計) 專用助手 - 品牌視覺與創意設計"""

    # 工作流程類型
    WORKFLOW_VISUAL_CONCEPT = "visual_concept"  # 視覺概念發想
    WORKFLOW_CAMPAIGN_VISUAL = "campaign_visual"  # 活動視覺規劃
    WORKFLOW_BRAND_GUIDELINE = "brand_guideline"  # 品牌視覺規範
    WORKFLOW_SOCIAL_VISUAL = "social_visual"  # 社群視覺設計
    WORKFLOW_PACKAGE_DESIGN = "package_design"  # 包裝設計
    WORKFLOW_SPACE_DESIGN = "space_design"  # 空間視覺設計

    def __init__(self):
        # 主系統提示詞
        system_prompt = """你是弘爺漢堡視覺設計師 (人員 C) 的專屬 AI 助手。

## 核心職責
- 品牌視覺規劃與設計
- 活動主視覺創意發想
- 社群視覺內容設計
- 包裝與周邊商品設計
- 門市空間視覺規劃
- 品牌視覺一致性把關

## 工作特性
- 創意與美感並重
- 需符合品牌調性
- 考慮製作可行性
- 重視視覺溝通效果

## 品牌視覺參考
- 弘爺漢堡: 台式復古風、親切溫暖、現做現煎
- 主色調: 紅色系（熱情活力）、黃色系（美味溫暖）
- 視覺風格: 接地氣、有溫度、不過度精緻
- 避免: 過於西式、冷調、過度設計感

## 可用框架工具
- 視覺概念發想框架
- 設計 Brief 框架
- 色彩心理學
- 視覺層級理論

## 協作助理
您可以調用以下專業助理協助工作：
- 簡報製作助理：協助製作提案簡報
- 文案創作助理：視覺文案配合
- 品牌策略助理：確保品牌一致性

根據用戶的需求，選擇適當的框架與工具提供專業建議。"""

        super().__init__(
            assistant_type="personnel_c",
            system_prompt=system_prompt,
            use_anthropic=True,
        )

    def get_welcome_message(self) -> str:
        """獲取歡迎訊息"""
        return """
# 歡迎使用人員 C (視覺設計) AI Agent 🎨

我是弘爺漢堡視覺設計師的專屬 AI 助手！

## 📋 我能協助您

### 🎨 創意發想
**1️⃣ 視覺概念發想**
從零開始的創意發想與方向建議

**2️⃣ 活動視覺規劃**
完整活動主視覺與延伸應用

### 🎯 品牌設計
**3️⃣ 品牌視覺規範**
建立或優化品牌視覺規範

**4️⃣ 社群視覺設計**
社群平台視覺內容規劃

### 📦 應用設計
**5️⃣ 包裝設計**
產品包裝與周邊商品設計

**6️⃣ 空間視覺設計**
門市與活動空間視覺規劃

## 💡 快速啟動

**創意發想：**
- `/concept` - 視覺概念發想
- `/campaign` - 活動視覺規劃

**品牌設計：**
- `/brand` - 品牌視覺規範
- `/social` - 社群視覺設計

**應用設計：**
- `/package` - 包裝設計
- `/space` - 空間視覺設計

**查看所有：**
- `/workflows` - 查看所有工作流程

或直接描述您的需求，我會提供專業設計建議！

準備好開始了嗎？
"""

    def get_help_message(self) -> str:
        """獲取幫助訊息"""
        return """
# 人員 C (視覺設計) 助手使用指南

## 📋 支援的工作流程

### 1. 視覺概念發想
**使用時機：** 需要創意發想或視覺方向
**輸入指令：** `/concept`
**需要資訊：**
- 專案目的
- 目標受眾
- 品牌調性
- 參考案例或風格偏好

**輸出內容：**
- 3 個視覺概念方向
- 每個方向的：
  * 核心概念
  * 視覺元素建議
  * 色彩配置
  * 字體建議
  * 情緒板參考
- 優劣勢分析
- 製作可行性評估

---

### 2. 活動視覺規劃
**使用時機：** 規劃活動主視覺與延伸應用
**輸入指令：** `/campaign`
**需要資訊：**
- 活動名稱與主題
- 活動目的
- 目標受眾
- 應用範圍（線上/線下）
- 預算規模

**輸出內容：**
- 主視覺概念（2-3 個方向）
- 視覺系統規劃
  * 主視覺
  * 次視覺
  * 輔助圖形
- 延伸應用設計
  * 社群貼文模板
  * 海報/DM
  * 門市佈置
  * 周邊商品
- 設計規格說明
- 製作時程建議
- 預算分配建議

---

### 3. 品牌視覺規範
**使用時機：** 建立或更新品牌視覺系統
**輸入指令：** `/brand`
**需要資訊：**
- 品牌現況
- 規範目的（新建/優化/延伸）
- 應用範圍
- 特殊需求

**輸出內容：**
- 品牌視覺規範建議
  * Logo 使用規範
  * 色彩系統
  * 字體系統
  * 輔助圖形
  * 攝影風格
  * 版面編排原則
- 應用範例展示
- 禁止事項說明
- 執行注意事項

---

### 4. 社群視覺設計
**使用時機：** 規劃社群平台視覺內容
**輸入指令：** `/social`
**需要資訊：**
- 平台類型（FB/IG/LINE）
- 內容類型
- 視覺風格偏好
- 產出頻率

**輸出內容：**
- 社群視覺策略
- 模板系統設計
  * 貼文模板（3-5 款）
  * 限時動態模板
  * 大頭貼/封面設計
- 視覺元素庫建議
  * 圖示系統
  * 插圖風格
  * 照片處理風格
- 製作效率建議
- 工具與資源推薦

---

### 5. 包裝設計
**使用時機：** 設計產品包裝或周邊商品
**輸入指令：** `/package`
**需要資訊：**
- 產品類型
- 包裝規格
- 目標受眾
- 預算範圍
- 特殊需求（環保/功能）

**輸出內容：**
- 包裝設計概念（2-3 個方向）
- 設計元素說明
  * 視覺主題
  * 色彩計畫
  * 圖文配置
  * 材質建議
- 結構與尺寸建議
- 製作工藝建議
- 成本預估
- 供應商建議類型

---

### 6. 空間視覺設計
**使用時機：** 門市或活動空間視覺規劃
**輸入指令：** `/space`
**需要資訊：**
- 空間類型（門市/快閃店/活動）
- 空間大小與格局
- 預算規模
- 期望效果

**輸出內容：**
- 空間視覺概念
- 視覺元素規劃
  * 主牆設計
  * 氛圍營造
  * 動線規劃
  * 拍照打卡點
- 製作物清單
  * 大型輸出
  * 立體裝置
  * 小物佈置
- 施工注意事項
- 預算分配建議
- 廠商協調重點

---

## 🎯 使用技巧

### 快速指令
- `/workflows` - 查看所有工作流程
- `/concept` - 視覺概念發想
- `/campaign` - 活動視覺規劃
- `/brand` - 品牌視覺規範
- `/social` - 社群視覺設計
- `/package` - 包裝設計
- `/space` - 空間視覺設計

### 自然對話
您也可以直接描述需求，例如：
- "我需要母親節活動的主視覺概念"
- "幫我規劃 IG 的視覺風格"
- "設計一個聯名漢堡的包裝"
- "快閃店的空間視覺怎麼做？"

## 💡 最佳實踐

1. **提供參考** - 分享喜歡的視覺案例或風格
2. **明確限制** - 說明預算、時程、製作限制
3. **考慮應用** - 思考視覺在各種場景的應用
4. **品牌一致** - 確保符合弘爺漢堡品牌調性
5. **可執行性** - 評估設計的製作可行性

需要開始使用嗎？輸入 `/workflows` 查看所有工作流程！
"""

    def get_workflow_prompt(self, workflow_type: str, context: Dict = None) -> str:
        """
        獲取特定工作流程的提示詞

        Args:
            workflow_type: 工作流程類型
            context: 上下文資訊

        Returns:
            工作流程提示詞
        """
        workflows = {
            self.WORKFLOW_VISUAL_CONCEPT: self._get_visual_concept_prompt,
            self.WORKFLOW_CAMPAIGN_VISUAL: self._get_campaign_visual_prompt,
            self.WORKFLOW_BRAND_GUIDELINE: self._get_brand_guideline_prompt,
            self.WORKFLOW_SOCIAL_VISUAL: self._get_social_visual_prompt,
            self.WORKFLOW_PACKAGE_DESIGN: self._get_package_design_prompt,
            self.WORKFLOW_SPACE_DESIGN: self._get_space_design_prompt,
        }

        prompt_func = workflows.get(workflow_type)
        if prompt_func:
            return prompt_func(context or {})
        return ""

    def _get_visual_concept_prompt(self, context: Dict) -> str:
        """視覺概念發想提示詞"""
        return """請幫我進行視覺概念發想。

**視覺概念發想流程：**

**1. 理解需求**
- 專案目標
- 目標受眾
- 品牌調性
- 使用情境

**2. 概念發想**
- 核心概念提取
- 視覺隱喻
- 情感連結
- 差異化策略

**3. 視覺轉譯**
- 色彩策略
- 視覺元素
- 排版風格
- 材質與質感

**4. 可行性評估**
- 製作難度
- 成本預估
- 時程評估

請根據以下資訊進行視覺概念發想：

【請在此描述您的視覺需求】
- 專案名稱：
- 專案目的：
- 目標受眾：（年齡/性別/特徵）
- 品牌調性：（弘爺漢堡 + 專案特殊調性）
- 應用範圍：（線上/線下/印刷/數位）
- 參考風格：（如有）
- 預算規模：
- 製作時程：
- 特殊限制：

我將為您提供：
✅ 3 個完整視覺概念方向
  每個方向包含：
  - 核心概念說明
  - 視覺關鍵字
  - 色彩配置（主色/輔色/點綴色）
  - 視覺元素建議（圖形/圖像/材質）
  - 字體建議（中文/英文/數字）
  - 情緒板/風格參考
  - 優勢與特色
  - 潛在挑戰
✅ 三個方向的比較分析
✅ 推薦方案與理由
✅ 製作可行性評估
✅ 延伸應用建議
"""

    def _get_campaign_visual_prompt(self, context: Dict) -> str:
        """活動視覺規劃提示詞"""
        return """請幫我規劃活動視覺。

**活動視覺規劃架構：**

**1. 主視覺設計**
- 視覺概念
- 主視覺構成
- 標準組合

**2. 視覺系統**
- 色彩系統
- 圖形系統
- 字體系統

**3. 延伸應用**
- 數位應用
- 印刷物
- 空間佈置
- 周邊商品

**4. 製作規範**
- 檔案規格
- 製作注意事項
- 供應商協調

請根據以下資訊規劃活動視覺：

【請在此描述您的活動視覺需求】
- 活動名稱：
- 活動主題：
- 活動目的：
- 活動期間：
- 目標受眾：
- 應用範圍：
  □ 社群媒體（FB/IG/LINE）
  □ 印刷物（海報/DM/立牌）
  □ 門市佈置
  □ 周邊商品
  □ 其他：
- 視覺風格偏好：
- 預算規模：
- 特殊需求：

我將為您提供：
✅ 主視覺概念（2-3 個方向）
✅ 完整視覺系統規劃
  - 主視覺設計
  - 次視覺變化
  - 輔助圖形
  - 色彩系統
  - 字體系統
✅ 延伸應用設計
  - 社群貼文模板（3-5 款）
  - 海報/DM 設計
  - 門市佈置規劃
  - 周邊商品建議
✅ 設計規格說明
✅ 製作時程建議
✅ 預算分配建議
✅ 供應商建議類型
"""

    def _get_brand_guideline_prompt(self, context: Dict) -> str:
        """品牌視覺規範提示詞"""
        return """請幫我規劃品牌視覺規範。

**品牌視覺規範架構：**

**1. 基礎系統**
- Logo 系統
- 色彩系統
- 字體系統

**2. 應用規範**
- 基本應用
- 延伸應用
- 數位應用

**3. 視覺元素**
- 輔助圖形
- 圖示系統
- 攝影風格

**4. 執行指南**
- 正確使用範例
- 錯誤使用範例
- 特殊情況處理

請根據以下資訊規劃品牌視覺規範：

【請在此描述您的規範需求】
- 規範目的：（新建/優化/延伸/特定專案）
- 品牌現況：
- 應用範圍：
  □ 企業識別
  □ 產品包裝
  □ 數位媒體
  □ 門市空間
  □ 周邊商品
  □ 其他：
- 目標使用者：（內部團隊/外部廠商/加盟主）
- 特殊需求：

我將為您提供：
✅ 完整品牌視覺規範建議
  **基礎系統：**
  - Logo 使用規範（標準色/單色/反白/最小尺寸/安全距離）
  - 色彩系統（主色/輔色/中性色/色彩比例/色號標示）
  - 字體系統（中文/英文/數字/使用情境）

  **視覺元素：**
  - 輔助圖形設計與應用
  - 圖示系統規範
  - 攝影風格指南（構圖/色調/主題）
  - 插圖風格（如需要）

  **應用規範：**
  - 名片/信封/信紙
  - 簡報模板
  - 社群媒體
  - 包裝系統
  - 門市空間

  **執行指南：**
  - 正確使用範例
  - 禁止事項（標示清楚的錯誤範例）
  - 特殊情況處理原則

✅ 規範手冊架構建議
✅ 執行注意事項
✅ 管理與更新機制建議
"""

    def _get_social_visual_prompt(self, context: Dict) -> str:
        """社群視覺設計提示詞"""
        return """請幫我規劃社群視覺設計。

**社群視覺設計重點：**

**1. 平台特性**
- 版面規格
- 瀏覽習慣
- 互動特性

**2. 視覺策略**
- 風格定位
- 模板系統
- 產出效率

**3. 內容類型**
- 產品展示
- 優惠資訊
- 品牌內容
- 互動活動

**4. 執行效率**
- 模板設計
- 素材管理
- 工具運用

請根據以下資訊規劃社群視覺：

【請在此描述您的社群視覺需求】
- 經營平台：（FB/IG/LINE/Threads）
- 目前狀況：
- 視覺問題或挑戰：
- 內容類型比例：
  - 產品/服務介紹：___%
  - 優惠促銷：___%
  - 品牌故事：___%
  - 互動活動：___%
  - 其他：___%
- 發布頻率：
- 製作資源：（專職設計師/兼職/外包）
- 視覺風格偏好：
- 特殊需求：

我將為您提供：
✅ 社群視覺策略
  - 整體風格定位
  - 各平台視覺差異化
  - 視覺記憶點設計

✅ 模板系統設計
  - 貼文模板（3-5 款）
    * 產品型
    * 優惠型
    * 品牌型
    * 互動型
  - 限時動態模板（2-3 款）
  - 大頭貼/封面設計

✅ 視覺元素庫
  - 品牌圖示系統
  - 輔助圖形
  - 插圖風格建議
  - 照片處理風格
  - 文字排版系統

✅ 製作效率建議
  - 工作流程優化
  - 工具推薦（Canva/Figma/PS）
  - 素材管理方式
  - 外包協調建議

✅ 視覺規格表
✅ 檔案命名與管理建議
"""

    def _get_package_design_prompt(self, context: Dict) -> str:
        """包裝設計提示詞"""
        return """請幫我規劃包裝設計。

**包裝設計考量：**

**1. 功能性**
- 保護功能
- 使用便利性
- 儲存運輸

**2. 視覺性**
- 品牌識別
- 貨架吸引力
- 資訊傳達

**3. 成本效益**
- 材質選擇
- 製作工藝
- 量產可行性

**4. 永續性**
- 環保材質
- 減量設計
- 回收考量

請根據以下資訊規劃包裝設計：

【請在此描述您的包裝設計需求】
- 產品名稱：
- 產品類型：（漢堡/飲料/套餐/周邊商品）
- 包裝目的：（外帶/外送/零售/禮盒/聯名）
- 產品尺寸：
- 目標受眾：
- 使用情境：
- 預算規模：（經濟型/標準型/高檔型）
- 預計數量：
- 特殊需求：
  □ 環保材質
  □ 特殊功能（保溫/防漏）
  □ 禮品包裝
  □ 聯名設計
  □ 其他：

我將為您提供：
✅ 包裝設計概念（2-3 個方向）
  每個方向包含：
  - 設計概念說明
  - 視覺效果圖
  - 結構與尺寸
  - 材質建議

✅ 完整設計規劃
  - 視覺主題與風格
  - 色彩計畫
  - 圖文配置
  - 資訊層級規劃
  - 特殊工藝建議（燙金/上光/特殊印刷）

✅ 製作規範
  - 尺寸與展開圖
  - 材質規格
  - 印刷工藝
  - 組裝方式

✅ 成本評估
  - 各方案成本預估
  - 成本優化建議
  - 量產門檻說明

✅ 供應商建議
  - 適合的廠商類型
  - 打樣注意事項
  - 驗收重點
"""

    def _get_space_design_prompt(self, context: Dict) -> str:
        """空間視覺設計提示詞"""
        return """請幫我規劃空間視覺設計。

**空間視覺設計重點：**

**1. 空間分析**
- 格局與動線
- 光線與氛圍
- 限制與機會

**2. 視覺規劃**
- 主視覺設計
- 分區視覺
- 拍照打卡點

**3. 製作執行**
- 製作物規劃
- 施工協調
- 成本控制

**4. 體驗設計**
- 顧客動線
- 視覺驚喜
- 品牌體驗

請根據以下資訊規劃空間視覺：

【請在此描述您的空間視覺需求】
- 空間類型：
  □ 新門市
  □ 門市改裝
  □ 快閃店
  □ 活動空間
  □ 展覽攤位
  □ 其他：
- 空間大小：（坪數或尺寸）
- 格局說明：（或提供平面圖）
- 使用期間：（長期/短期）
- 視覺主題：
- 預算規模：
- 期望效果：
- 特殊需求：

我將為您提供：
✅ 空間視覺概念
  - 整體設計概念
  - 視覺主題
  - 氛圍營造策略
  - 拍照打卡點設計

✅ 視覺元素規劃
  **主視覺區：**
  - 主牆設計
  - 招牌/門面
  - 特色裝置

  **功能區視覺：**
  - 點餐區
  - 用餐區
  - 等候區
  - 動線指引

  **氛圍營造：**
  - 色彩計畫
  - 燈光建議
  - 音樂風格
  - 氣味考量

✅ 製作物清單
  - 大型輸出物（尺寸/材質/安裝方式）
  - 立體裝置（設計/材質/結構）
  - 小物佈置（品項/數量/配置）
  - 照明規劃

✅ 執行規劃
  - 施工時程
  - 施工注意事項
  - 廠商協調重點
  - 驗收檢查清單

✅ 預算分配
  - 各項目成本估算
  - 優先級建議
  - 成本優化方案
"""

    def start_workflow(self, workflow_type: str, user_input: str = "") -> str:
        """
        啟動特定工作流程

        Args:
            workflow_type: 工作流程類型
            user_input: 用戶輸入

        Returns:
            助手回應
        """
        # 獲取工作流程提示詞
        workflow_prompt = self.get_workflow_prompt(workflow_type)

        if not workflow_prompt:
            return "抱歉，不支援此工作流程。請輸入 /workflows 查看所有可用的工作流程。"

        # 組合完整訊息
        full_message = f"{workflow_prompt}\n\n{user_input}" if user_input else workflow_prompt

        # 使用 chat 方法處理
        return self.chat(full_message)

    def list_workflows(self) -> str:
        """列出所有可用的工作流程"""
        return """
# 人員 C (視覺設計) 可用工作流程

## 🎨 創意發想類
1. **視覺概念發想** (`/concept`)
   - 從零開始的創意發想
   - 提供 3 個視覺方向

2. **活動視覺規劃** (`/campaign`)
   - 完整活動視覺系統
   - 主視覺與延伸應用

## 🎯 品牌設計類
3. **品牌視覺規範** (`/brand`)
   - 品牌視覺系統建立
   - 完整使用規範

4. **社群視覺設計** (`/social`)
   - 社群平台視覺規劃
   - 模板系統設計

## 📦 應用設計類
5. **包裝設計** (`/package`)
   - 產品包裝規劃
   - 周邊商品設計

6. **空間視覺設計** (`/space`)
   - 門市與活動空間
   - 完整視覺規劃

---

**快速使用：** 直接輸入指令（如 `/concept`）或描述您的需求！
"""
